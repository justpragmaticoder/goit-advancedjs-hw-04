{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from \"axios\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst IZI_TOAST_TIMEOUT = 2000;\nconst IZI_TOAST_MAX_WIDTH = 350;\nconst ITEMS_PER_PAGE = 40;\nconst PHOTO_SERVICE_KEY = '44262715-0f0c36fa7bed0278a9188117f';\n\nasync function searchPhotoHandler(event, inputData) {\n  event.preventDefault();\n  inputData.searchQuery = inputData.elements.searchForm[0].value.trim().toLowerCase();\n  inputData.elements.btnLoadMore.classList.add(\"is_hidden\");\n\n  if (inputData.searchQuery) {\n    inputData.page = 1;\n    inputData.elements.searchForm.reset();\n\n    try {\n      const data = await getServicePhoto(inputData, ITEMS_PER_PAGE);\n      if (!data.hits.length) {\n        iziToast.error({\n          message:\n            \"Sorry, there are no images matching your search query. Please try again.\",\n        });\n        inputData.elements.gallery.innerHTML = \"<div></div>\";\n        return;\n      }\n\n      iziToast.success({\n        message: `Hooray! We found ${data.totalHits} images.`,\n      });\n      inputData.elements.gallery.innerHTML = createMarkupGallary(data.hits);\n      inputData.lightbox.refresh();\n    } catch (error) {\n      console.log(error);\n      iziToast.error({\n        title: \"ðŸ”» Oops!\",\n        message: error.message ?? \"Something went wrong!\",\n        position: \"topCenter\",\n      });\n    }\n  } else {\n    iziToast.warning({\n      message: \"Fill in the search field!\",\n    });\n    inputData.elements.gallery.innerHTML = \"<div></div>\";\n  }\n}\n\nasync function loadMoreHandler(inputData) {\n  inputData.page += 1;\n\n  try {\n    const data = await getServicePhoto(inputData, ITEMS_PER_PAGE);\n\n    inputData.elements.gallery.insertAdjacentHTML(\n      \"beforeend\",\n      createMarkupGallary(data.hits)\n    );\n    inputData.lightbox.refresh();\n    inputData.cardHeight =\n      inputData.elements.gallery.firstElementChild.getBoundingClientRect();\n\n    scrollBy({\n      top: inputData.cardHeight.height * 3,\n      behavior: \"smooth\",\n    });\n\n    if (inputData.page >= data.totalHits / ITEMS_PER_PAGE) {\n      inputData.elements.btnLoadMore.classList.add(\"is_hidden\");\n    }\n  } catch (error) {\n    console.log(error);\n    iziToast.error({\n      title: \"ðŸ”» Oops!\",\n      message: error.message ?? \"Something went wrong!\",\n      position: \"topCenter\",\n    });\n  }\n}\n\nfunction createMarkupGallary(arr) {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n    <div class=\"photo-card\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <div class=\"thumb\">\n                <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" width=\"360\" />\n            </div>\n                <div class=\"info\">\n                    <p class=\"info-item\">\n                        <b>Likes</b> ${likes}\n                    </p>\n                    <p class=\"info-item\">\n                        <b>Views</b> ${views}\n                    </p>\n                    <p class=\"info-item\">\n                        <b>Comments</b> ${comments}\n                    </p>\n                    <p class=\"info-item\">\n                        <b>Downloads</b> ${downloads}\n                    </p>\n            </div>\n        </a>\n    </div>\n    `\n    )\n    .join(\"\");\n}\n\nasync function getServicePhoto(inputData, per_page) {\n  const options = {\n    params: {\n      key: PHOTO_SERVICE_KEY,\n      q: inputData.searchQuery,\n      image_type: \"photo\",\n      orientation: \"horizontal\",\n      safesearch: true,\n      per_page,\n      page: inputData.page,\n    },\n  };\n\n  const { data } = await axios.get(\"https://pixabay.com/api/\", options);\n\n  if (inputData.page <= data.totalHits / per_page) {\n    inputData.elements.btnLoadMore.classList.remove(\"is_hidden\");\n  } else if (data.totalHits) {\n    console.log(data.totalHits);\n    iziToast.error({\n      message: \"We're sorry, but you've reached the end of search results.\",\n    });\n  }\n\n  return data;\n}\n\n(() => {\n  iziToast.settings({\n    timeout: IZI_TOAST_TIMEOUT,\n    position: \"topRight\",\n    transitionIn: \"fadeInRight\",\n    transitionOut: \"fadeOutLeft\",\n    maxWidth: IZI_TOAST_MAX_WIDTH,\n  });\n\n  const lightbox = new SimpleLightbox(\".photo-card a\", {});\n  const elements = {\n    searchForm: document.querySelector(\".search-form\"),\n    gallery: document.querySelector(\".gallery\"),\n    btnLoadMore: document.querySelector(\".load-more\"),\n  };\n\n  const inputData = {\n    cardHeight: undefined,\n    page: 1,\n    searchQuery: undefined,\n    lightbox,\n    elements,\n  };\n\n  elements.searchForm.addEventListener(\"submit\", (event) =>\n    searchPhotoHandler(event, inputData)\n  );\n\n  elements.btnLoadMore.addEventListener(\"click\", () =>\n    loadMoreHandler(inputData)\n  );\n})();\n"],"names":["IZI_TOAST_TIMEOUT","IZI_TOAST_MAX_WIDTH","ITEMS_PER_PAGE","PHOTO_SERVICE_KEY","searchPhotoHandler","event","inputData","data","getServicePhoto","iziToast","createMarkupGallary","error","loadMoreHandler","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","per_page","options","axios","lightbox","SimpleLightbox","elements"],"mappings":"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"}